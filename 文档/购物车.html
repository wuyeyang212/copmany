<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>购物车</title>
    <script src="js2/jquery.min.js"></script>
    <link rel="stylesheet" href="css2/coman.css">
    <link rel="stylesheet" type="text/css" href="css2/mui.min.css">
    <link rel="stylesheet" href="css2/product.css">
    <script src="js2/jquery.min.js"></script>
    <script src="js2/cart.js"></script>
    <style>
        html {
            font-size: 36px;
        }
    </style>
</head>

<body style="max-width:640px;margin:0 auto">
    <header style="max-width:640px;margin:0 auto">
        <a href="history.go(-1)" class="mui-icon mui-icon-arrowleft gun-yu"></a>
        <div class="zh-ji">
            购物车
        </div>
    </header>
<div class="b-g-box-m">
    <div class="b-g-box">
        <div class="b-c-box di-b ">
            <div class="box-zhu">
                <input type="checkbox" id="shop_a" class="shopChoice">
                <label for="shop_a" class=""></label>

            </div>
            <img src="image/家乡.png" alt="" class="img-srr">
            <span class="hi-title">自营仓发送</span>
        </div>
        <div class="b-c-box" lo="0">
            <div class="box-left">
                <input type="checkbox" id="checkbox_2" class="son_check">
                <label for="checkbox_2" class=""></label>

            </div>
            <div class="box-right">
                <div class="v-co-nei">
                    <div class="v-co-img">
                        <img src="images/x-z.png" alt="">
                    </div>
                    <div class="gu-nei">
                        <div class="v-y-j">
                            <div class="g-w-z">
                                <span class="t-x-g">限时购</span>
                                【官方直采】Merries 花王妙而舒 XL 38片/包 3包装 拉拉裤/学步裤
                            </div>
                            <div class="x-m-z">
                                <div class="fle-kk">
                                    <div class="fll-x"></div>
                                    <div class="fle-bottom">
                                        <div class="fee-er" dang="32">
                                            预估积分:
                                            <span class="yu-fee">
                                                32
                                            </span>
                                        </div>
                                        <div class="v-cartitem-price" cc="1">
                                            <span>积分:258</span>
                                        </div>
                                    </div>

                                </div>
                                <div class="kk-be">

                                    <div class="v-numberpoint">

                                        <div class="v-numberinput-inner" sun-data="0" price="258">
                                            <div class="re-miu">
                                                -
                                            </div>
                                            <input type="text" value="1" class="hir">
                                            <div class="re-mius">
                                                +
                                            </div>

                                        </div>
                                    </div>
                                    <div class="shanchu">
                                        <div class="s-k">
                                            <img src="images/删除.png" alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="b-c-box" lo="0">
            <div class="box-left">
                <input type="checkbox" id="checkbox_3" class="son_check">
                <label for="checkbox_3" class=""></label>

            </div>
            <div class="box-right">
                <div class="v-co-nei">
                    <div class="v-co-img">
                        <img src="images/x-z.png" alt="">
                    </div>
                    <div class="gu-nei">
                        <div class="v-y-j">
                            <div class="g-w-z">
                                <span class="t-x-g">限时购</span>
                                【官方直采】Merries 花王妙而舒 XL 38片/包 3包装 拉拉裤/学步裤
                            </div>
                            <div class="x-m-z">
                                <div class="fle-kk">
                                    <div class="fll-x"></div>
                                    <div class="fle-bottom">
                                        <div class="fee-er" dang="32">
                                            预估积分:
                                            <span class="yu-fee">
                                                32
                                            </span>
                                        </div>
                                        <div class="v-cartitem-price" cc="1">
                                            <span>积分:258</span>
                                        </div>
                                    </div>

                                </div>
                                <div class="kk-be">

                                    <div class="v-numberpoint">

                                        <div class="v-numberinput-inner" sun-data="0" price="258">
                                            <div class="re-miu">
                                                -
                                            </div>
                                            <input type="text" value="1" class="hir">
                                            <div class="re-mius">
                                                +
                                            </div>

                                        </div>
                                    </div>
                                    <div class="shanchu">
                                        <div class="s-k">
                                            <img src="images/删除.png" alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="shoufei">
            <div class="neirongx">
                <div class="zuobian">
                    <div>活动</div>
                    <div>本仓总计（不含税):</div>
                </div>
                <div class="zuobian">
                    <div>￥33</div>
                    <div>￥23</div>
                </div>
            </div>
        </div>
    </div>
    <div class="b-g-box ">
        <div class="b-c-box di-b ">
            <div class="box-zhu">
                <input type="checkbox" id="shop_a" class="shopChoice">
                <label for="shop_a" class=""></label>

            </div>
            <img src="image/家乡.png" alt="" class="img-srr">
            <span class="hi-title">自营仓发送</span>
        </div>
        <div class="b-c-box" lo="0">
            <div class="box-left">
                <input type="checkbox" id="checkbox_2" class="son_check">
                <label for="checkbox_2" class=""></label>

            </div>
            <div class="box-right">
                <div class="v-co-nei">
                    <div class="v-co-img">
                        <img src="images/x-z.png" alt="">
                    </div>
                    <div class="gu-nei">
                        <div class="v-y-j">
                            <div class="g-w-z">
                                <span class="t-x-g">限时购</span>
                                【官方直采】Merries 花王妙而舒 XL 38片/包 3包装 拉拉裤/学步裤
                            </div>
                            <div class="x-m-z">
                                <div class="fle-kk">
                                    <div class="fll-x"></div>
                                    <div class="fle-bottom">
                                        <div class="fee-er" dang="32">
                                            预估积分:
                                            <span class="yu-fee">
                                                32
                                            </span>
                                        </div>
                                        <div class="v-cartitem-price" cc="1">
                                            <span>积分:258</span>
                                        </div>
                                    </div>

                                </div>
                                <div class="kk-be">

                                    <div class="v-numberpoint">

                                        <div class="v-numberinput-inner" sun-data="0" price="258">
                                            <div class="re-miu">
                                                -
                                            </div>
                                            <input type="text" value="1" class="hir">
                                            <div class="re-mius">
                                                +
                                            </div>

                                        </div>
                                    </div>
                                    <div class="shanchu">
                                        <div class="s-k">
                                            <img src="images/删除.png" alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="b-c-box" lo="0">
            <div class="box-left">
                <input type="checkbox" id="checkbox_3" class="son_check">
                <label for="checkbox_3" class=""></label>

            </div>
            <div class="box-right">
                <div class="v-co-nei">
                    <div class="v-co-img">
                        <img src="images/x-z.png" alt="">
                    </div>
                    <div class="gu-nei">
                        <div class="v-y-j">
                            <div class="g-w-z">
                                <span class="t-x-g">限时购</span>
                                【官方直采】Merries 花王妙而舒 XL 38片/包 3包装 拉拉裤/学步裤
                            </div>
                            <div class="x-m-z">
                                <div class="fle-kk">
                                    <div class="fll-x"></div>
                                    <div class="fle-bottom">
                                        <div class="fee-er" dang="32">
                                            预估积分:
                                            <span class="yu-fee">
                                                32
                                            </span>
                                        </div>
                                        <div class="v-cartitem-price" cc="1">
                                            <span>积分:258</span>
                                        </div>
                                    </div>

                                </div>
                                <div class="kk-be">

                                    <div class="v-numberpoint">

                                        <div class="v-numberinput-inner" sun-data="0" price="258">
                                            <div class="re-miu">
                                                -
                                            </div>
                                            <input type="text" value="1" class="hir">
                                            <div class="re-mius">
                                                +
                                            </div>

                                        </div>
                                    </div>
                                    <div class="shanchu">
                                        <div class="s-k">
                                            <img src="images/删除.png" alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="shoufei">
            <div class="neirongx">
                <div class="zuobian">
                    <div>活动</div>
                    <div>本仓总计（不含税):</div>
                </div>
                <div class="zuobian">
                    <div>￥33</div>
                    <div>￥23</div>
                </div>
            </div>
        </div>
    </div>
</div>
 
    <div class="jiesuan" style="max-width:640px;margin:0 auto">
        <div class="bo">
            <div class="x-r">
                <input type="checkbox" id="all" class="quan_check">
                <label for="all" class=""></label>
            </div>
            <div class="s-kr">
                全选
            </div>
        </div>
        <div class="bo-di">
            <div class="cer">总价:
                <span class="z-b">2555</span>
            </div>
            <div class="cer xi">预估税费:
                <span class="t-yu-fee">156465</span>
            </div>
        </div>
        <div class="jie-btn">
            <div class="wen-zi">结算</div>
        </div>
    </div>
    <!-- 关于模态框的写法 -->
    <div class="motai"></div>
    <div class="chuxian">
        <div class="s-we-zi">确定要删除吗?</div>
        <div class="btn">
            <span class="byn-f red">确定</span>
            <span class="byn-f gray">取消</span>
        </div>
    </div>
    <!-- <script src="js/cart.js"></script> -->
    <script>
        $(function () {
            var $allCheckbox = $('input[type="checkbox"]'), //这个是全部的全局盒子
                $wholeChexbox = $('.quan_check'), //这个是全选的盒子
                $shopabox = $('.b-g-box'),
                $shopCheckbox = $('.shopChoice'),//每个店铺的盒子
                $cartBox = $('.b-c-box'),
            $sonCheckBox = $('.son_check');
            $allCheckbox.click(function () {
                if ($(this).is(':checked')) {
                    $(this).next('label').addClass('mark');
                } else {
                    $(this).next('label').removeClass('mark')
                }

            });
            totalMoney();
            $wholeChexbox.click(function () {
                var $checkboxs = $cartBox.find('input[type="checkbox"]');
                if ($(this).is(':checked')) {
                    $checkboxs.prop("checked", true);
                    $checkboxs.next('label').addClass('mark');
                } else {
                    $checkboxs.prop("checked", false);
                    $checkboxs.next('label').removeClass('mark');
                }
                totalMoney();
            });
            $sonCheckBox.each(function () {
                $(this).click(function () {
                    if ($(this).is(':checked')) {
                        //判断：所有单个商品是否勾选
                        var len = $sonCheckBox.length;
                        var num = 0;
                        $sonCheckBox.each(function () {
                            if ($(this).is(':checked')) {
                                num++;
                            }
                        });
                        if (num == len) {
                            $wholeChexbox.prop("checked", true);
                            $wholeChexbox.next('label').addClass('mark');
                        }
                    } else {
                        //单个商品取消勾选，全局全选取消勾选
                        $wholeChexbox.prop("checked", false);
                        $wholeChexbox.next('label').removeClass('mark');
                    }
                    totalMoney();
                })
                totalMoney();
            })

            var $jia = $(".re-mius");
            var $jian = $(".re-miu");
            var $all_sum = $(".hir")
            //=================================================每个商铺盒子==============================================
            $shopCheckbox.each(function(){
                $(this).click(function(){
                    if($(this).is(':checked')){
                       var len = $shopCheckbox.length;
                        var num = 0;
                        $shopCheckbox.each(function(){
                           if($(this).is(':checked')){
                               num++;
                           } 
                        });
                    if(num==len){
                         $wholeChexbox.prop("checked", true);
                        $wholeChexbox.next('label').addClass('mark'); 
                    } 
                         $(this).parents('.b-g-box').find('.son_check').prop("checked", true);
                        $(this).parents('.b-g-box').find('.son_check').next('label').addClass('mark');
                    }else{
                         $wholeChexbox.prop("checked", false);
                        $wholeChexbox.next('label').removeClass('mark');
                          $(this).parents('.b-g-box').find('.son_check').prop("checked",false);
                        $(this).parents('.b-g-box').find('.son_check').next('label').removeClass('mark');
                    }
                      totalMoney();
                });
            });
            //=================================================每个商铺儿子的盒子全选==============================================
            $shopabox.each(function(){
                var $this = $(this);
                var $sonChecks = $this.find('.son_check');
                $sonChecks.each(function(){
                    $(this).click(function(){
                        if($(this).is(':checked')){
                             var len = $sonChecks.length;
                             var num = 0;
                             $sonChecks.each(function () {
                                if ($(this).is(':checked')) {
                                    num++;
                                }
                            });
                            if (num == len) {
                                $(this).parents('.b-g-box').find('.shopChoice').prop("checked", true);
                                $(this).parents('.b-g-box').find('.shopChoice').next('label').addClass('mark');
                            }
                        }else{
                             $(this).parents('.b-g-box').find('.shopChoice').prop("checked", false);
                            $(this).parents('.b-g-box').find('.shopChoice').next('label').removeClass('mark');
                        }
                         totalMoney();
                    });
                });
            });
            //=================================================商品数量==============================================
            $jian.click(function () {
                var $inputVal = $(this).next(),
                    $count = parseInt($inputVal.val()) - 1,
                    $price = $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                        ".v-cartitem-price").children("span").html().substring(3),
                    $fee = $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                        ".fee-er").attr("dang"),
                    $pricetotal = $count * parseInt($price),
                    $totalfee = $count * parseInt($fee);

                $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                    ".fee-er").children("span").html($totalfee)
                $(this).parents(".b-c-box").attr("lo", $pricetotal);

                if ($count < 1) {
                    $count = 1
                    $(this).next('input').val($count);
                } else {
                    $(this).next('input').val($count);
                }

                totalMoney();
            })
            $jia.click(function () {

                var $inputVal = $(this).prev(),
                    $count = parseInt($inputVal.val()) + 1,
                    $price = $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                        ".v-cartitem-price").children("span").html().substring(3),
                    $fee = $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                        ".fee-er").attr("dang"),
                    $pricetotal = $count * parseInt($price),
                    $totalfee = $count * parseInt($fee);

                $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                    ".fee-er").children("span").html($totalfee)
                $(this).parents(".b-c-box").attr("lo", $pricetotal);

                $(this).prev('input').val($count);
                totalMoney();
            })
            $all_sum.keyup(function () {
                var count = 0,
                    $totalpricebj = $(this).parents(".b-c-box").attr("lo"),
                    $price = $(this).parents(".x-m-z").children(".fle-kk").children(".fle-bottom").children(
                        ".v-cartitem-price").children("span").html().substring(3),
                    $pricetotal = 0;
                if ($(this).val() == '') {
                    $(this).val('1');
                }
                $(this).val($(this).val().replace(/\D|^0/g, ''));
                $count = $(this).val();
                $priceTotal = $count * parseInt($price);
                $(this).attr('value', $count);
                $(this).parents(".b-c-box").attr("lo", $priceTotal);
                totalMoney();
            })
            //======================================移除商品========================================
            var $order_lists = null;
            var $order_content = '';
            $('.s-k').click(function () {
                $order_lists = $(this).parents('.b-c-box');
                $order_content = $order_lists.parents('.order_content');
                $('.motai').fadeIn(300);
                $('.chuxian').fadeIn(300);
            });

            function closeM() {
                $('.motai').fadeOut(300);
                $('.chuxian').fadeOut(300);
            }
            $('.gray').click(function () {
                closeM();
            })
            $('.red').click(
                function () {
                    $order_lists.remove();
                    closeM();
                    $sonCheckBox = $('.son_check');
                    totalMoney();
                }
            )
            //======================================总计==========================================

            function totalMoney() {
                var total_money = 0;
                var total_count = 0;
                var cal = $('wen-zi');
                $sonCheckBox.each(function () {
                    if ($(this).is(':checked')) {
                        var goods = parseInt($(this).parents('.b-c-box').attr("lo"));
                        var num = parseInt($(this).parents('.b-c-box').find('.yu-fee').html())
                        total_money += goods;
                        total_count += num;
                    }
                });
                $('.z-b').html(total_money);
                $('.t-yu-fee').html(total_count);
            }














        })
    </script>

</body>

</html>